html %>% html_element('div.rightColumn')
text = html %>%
html_element('div.rightColumn') %>%
html_text2()
cat(text)  ## (cat just prints the text more nicely)
#only the right table, excluding text
html %>% html_element('#steve') %>% html_table()
tables = html %>% html_elements('table')
html_table(tables)
#all the links
'https://en.wikipedia.org/wiki/Hyperlink' %>%
read_html() %>%
html_elements('a') %>%
length()
#onle the links in the body
'https://en.wikipedia.org/wiki/Hyperlink' %>%
read_html() %>%
html_elements('#content a') %>%
length()
library(purrr)
library(tibble)
library(tidyverse)
nKO <- 5 #No. of KO sample
nTAG <- 5 # No. of TAG sample
nWT <- 5 # No. of WT sample
set.seed(11)
geneB1 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 19, .08), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 19, .08), simplify = TRUE))
geneB8 <- rbind(replicate(n = 3, rnorm(nKO, 15, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 13.5, .08), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 13.5, .08), simplify = TRUE))
geneB15 <- rbind(replicate(n = 3, rnorm(nKO, 5.5, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 5, .08), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 5, .08), simplify = TRUE))
GOI1 <- data.frame(geneB1, geneB8, geneB15)
Hk1 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 20, .1), simplify = TRUE))
Hk2 <- rbind(replicate(n = 3, rnorm(nKO, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 22, .1), simplify = TRUE))
Hk_1 <- data.frame(Hk1, Hk2)
day15 <- data.frame(GOI1, Hk_1)
colnames(day15) <- c(paste0("geneB1_run", seq(1:3)), paste0("geneB8_run", seq(1:3)), paste0("geneB15_run", seq(1:3)), paste0("Hk1_run", seq(1:3)), paste0("Hk2_run", seq(1:3)))
day15$sampleID <- c(paste0("KO", seq(1, nKO)),
paste0("TAG", seq(1, nTAG)),
paste0("WT", seq(1, nWT))) #naming sample/ID
day15 <- day15[, c(ncol(day15), 1:ncol(day15) - 1)] #reordering: last column at the beginning and others are in the same sequence
day15$age <- rep("15days", times = nrow(day15)) #adding age to all. nrow means how many sample
day15$line <- c(rep("KO", times = nKO), rep("TAG", times = nTAG), rep("WT", times = nWT))
geneB1_1 <- rbind(replicate(n = 3, rnorm(nKO, 15, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 13, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 13, .07), simplify = TRUE))
geneB8_1 <- rbind(replicate(n = 3, rnorm(nKO, 11, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 9.5, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 9.5, .07), simplify = TRUE))
geneB15_1 <- rbind(replicate(n = 3, rnorm(nKO, 4, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 3.5, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 3.5, .07), simplify = TRUE))
GOI2 <- data.frame(geneB1_1, geneB8_1, geneB15_1)
month1 <- data.frame(GOI2, Hk_2)
Hk1_1 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 20, .1), simplify = TRUE))
Hk2_1 <- rbind(replicate(n = 3, rnorm(nKO, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 22, .1), simplify = TRUE))
Hk_2 <- data.frame(Hk1_1, Hk2_1)
month1 <- data.frame(GOI2, Hk_2)
colnames(month1) <- c(paste0("geneB1_run", seq(1:3)), paste0("geneB8_run", seq(1:3)), paste0("geneB15_run", seq(1:3)), paste0("Hk1_run", seq(1:3)), paste0("Hk2_run", seq(1:3)))
month1$sampleID <- c(paste0("KO", seq(nKO+1, 2*nKO)),
paste0("TAG", seq(nTAG+1, 2*nTAG)),
paste0("WT", seq(nWT+1, 2*nWT)))
month1 <- month1[, c(ncol(month1), 1:ncol(month1) - 1)]
month1$age <- rep("1month", times = nrow(month1))
month1$line <- c(rep("KO", times = nKO), rep("TAG", times = nTAG), rep("WT", times = nWT))
colnames(month1) <- c(paste0("geneB1_run", seq(1:3)), paste0("geneB8_run", seq(1:3)), paste0("geneB15_run", seq(1:3)), paste0("Hk1_run", seq(1:3)), paste0("Hk2_run", seq(1:3)))
month1$sampleID <- c(paste0("KO", seq(nKO+1, 2*nKO)),
paste0("TAG", seq(nTAG+1, 2*nTAG)),
paste0("WT", seq(nWT+1, 2*nWT)))
month1 <- month1[, c(ncol(month1), 1:ncol(month1) - 1)]
month1$age <- rep("1month", times = nrow(month1))
month1$line <- c(rep("KO", times = nKO), rep("TAG", times = nTAG), rep("WT", times = nWT))
geneB1_2 <- rbind(replicate(n = 3, rnorm(nKO, 12, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 10, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 10, .07), simplify = TRUE))
geneB8_2 <- rbind(replicate(n = 3, rnorm(nKO, 8, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 7, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 7, .07), simplify = TRUE))
geneB15_2 <- rbind(replicate(n = 3, rnorm(nKO, 4, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 3, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 3, .07), simplify = TRUE))
GOI3 <- data.frame(geneB1_2, geneB8_2, geneB15_2)
Hk1_2 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 20, .1), simplify = TRUE))
Hk2_2 <- rbind(replicate(n = 3, rnorm(nKO, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 22, .1), simplify = TRUE))
Hk_3 <- data.frame(Hk1_2, Hk2_2)
month3 <- data.frame(GOI3, Hk_3)
colnames(month3) <- c(paste0("geneB1_run", seq(1:3)), paste0("geneB8_run", seq(1:3)), paste0("geneB15_run", seq(1:3)), paste0("Hk1_run", seq(1:3)), paste0("Hk2_run", seq(1:3)))
month3$sampleID <- c(paste0("KO", seq(2*nKO+1, 3*nKO)),
paste0("TAG", seq(2*nTAG+1, 3*nTAG)),
paste0("WT", seq(2*nWT+1, 3*nWT)))
month3 <- month3[, c(ncol(month3), 1:ncol(month3) - 1)]
month3$age <- rep("3months", times = nrow(month3))
month3$line <- c(rep("KO", times = nKO), rep("TAG", times = nTAG), rep("WT", times = nWT))
pcr1 <- rbind(day15, month1, month3)
View(month1)
View(month1)
View(month3)
View(day15)
geneB1_1 <- rbind(replicate(n = 3, rnorm(nKO, 15, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 13, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 13, .07), simplify = TRUE))
geneB8_1 <- rbind(replicate(n = 3, rnorm(nKO, 11, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 9.5, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 9.5, .07), simplify = TRUE))
geneB15_1 <- rbind(replicate(n = 3, rnorm(nKO, 4, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 3.5, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 3.5, .07), simplify = TRUE))
GOI2 <- data.frame(geneB1_1, geneB8_1, geneB15_1)
Hk1_1 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 20, .1), simplify = TRUE))
Hk2_1 <- rbind(replicate(n = 3, rnorm(nKO, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 22, .1), simplify = TRUE))
Hk_2 <- data.frame(Hk1_1, Hk2_1)
month1 <- data.frame(GOI2, Hk_2)
colnames(month1) <- c(paste0("geneB1_run", seq(1:3)), paste0("geneB8_run", seq(1:3)), paste0("geneB15_run", seq(1:3)), paste0("Hk1_run", seq(1:3)), paste0("Hk2_run", seq(1:3)))
month1$sampleID <- c(paste0("KO", seq(nKO+1, 2*nKO)),
paste0("TAG", seq(nTAG+1, 2*nTAG)),
paste0("WT", seq(nWT+1, 2*nWT)))
month1 <- month1[, c(ncol(month1), 1:ncol(month1) - 1)]
month1$age <- rep("1month", times = nrow(month1))
month1$line <- c(rep("KO", times = nKO), rep("TAG", times = nTAG), rep("WT", times = nWT))
geneB1_2 <- rbind(replicate(n = 3, rnorm(nKO, 12, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 10, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 10, .07), simplify = TRUE))
geneB8_2 <- rbind(replicate(n = 3, rnorm(nKO, 8, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 7, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 7, .07), simplify = TRUE))
geneB15_2 <- rbind(replicate(n = 3, rnorm(nKO, 4, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 3, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 3, .07), simplify = TRUE))
GOI3 <- data.frame(geneB1_2, geneB8_2, geneB15_2)
Hk1_2 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 20, .1), simplify = TRUE))
Hk2_2 <- rbind(replicate(n = 3, rnorm(nKO, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 22, .1), simplify = TRUE))
Hk_3 <- data.frame(Hk1_2, Hk2_2)
month3 <- data.frame(GOI3, Hk_3)
colnames(month3) <- c(paste0("geneB1_run", seq(1:3)), paste0("geneB8_run", seq(1:3)), paste0("geneB15_run", seq(1:3)), paste0("Hk1_run", seq(1:3)), paste0("Hk2_run", seq(1:3)))
month3$sampleID <- c(paste0("KO", seq(2*nKO+1, 3*nKO)),
paste0("TAG", seq(2*nTAG+1, 3*nTAG)),
paste0("WT", seq(2*nWT+1, 3*nWT)))
month3 <- month3[, c(ncol(month3), 1:ncol(month3) - 1)]
month3$age <- rep("3months", times = nrow(month3))
month3$line <- c(rep("KO", times = nKO), rep("TAG", times = nTAG), rep("WT", times = nWT))
pcr1 <- rbind(day15, month1, month3)
View(pcr1)
a <- pcr1 %>% select_if(is.numeric) %>% colnames()
pcr1$Ct_geneB1 <- apply(pcr1[, c(grep("geneB1_", a, ignore.case = TRUE, value = T))], 1, mean)
pcr1$Ct_geneB8 <- apply(pcr1[, c(grep("geneB8_", a, ignore.case = TRUE, value = T))], 1, mean)
pcr1$Ct_geneB15 <- apply(pcr1[, c(grep("geneB15_", a, ignore.case = TRUE, value = T))], 1, mean)
pcr1$Ct_Hk1 <- apply(pcr1[, c(grep("Hk1", a, ignore.case = TRUE, value = T))], 1, mean)
pcr1$Ct_Hk2 <- apply(pcr1[, c(grep("Hk2", a, ignore.case = TRUE, value = T))], 1, mean)
data1 <- pcr1[, c("sampleID", "age", "line", "Ct_geneB1", "Ct_geneB8", "Ct_geneB15", "Ct_Hk1", "Ct_Hk2")]
View(data1)
efficiencies <- c(1.98, 2, 2.02, 2.01, 2.01)
names(efficiencies) <- c("B1", "B8", "B15", "Hk1", "Hk2")
calibrator <- data1[data1$line == "WT" & data1$age == "15days",] %>% select_if(is.numeric)
Ct_avg <- apply(calibrator, 2, mean)
Ct <- data1 %>% select_if(is.numeric)
delta_Ct <- matrix(nrow=nrow(Ct), ncol=ncol(Ct))
for(i in 1:ncol(Ct)) {
delta_Ct[ , i] <- Ct_avg[[i]] - Ct[ , i]
}
colnames(delta_Ct) <- c(paste0("delta", names(Ct)))
RQ <- matrix(nrow=nrow(delta_Ct), ncol=ncol(delta_Ct))
for(i in 1:length(efficiencies)) {
RQ[ , i] <-  efficiencies[i]^delta_Ct[,i]
}
colnames(RQ) <- c(paste0("RQ_", names(efficiencies)))
geoMean_Hk <- apply(RQ[, 4:5], 1, function(x) exp(mean(log(x))))
geoMean_Hk
final <- cbind(delta_Ct, RQ, geoMean_Hk)
View(final)
nGOI <- 3
Rel_expression <- matrix(nrow=nrow(final), ncol=nGOI)
for(i in 1:nGOI) {
Rel_expression[ , i] <-  RQ[, i]/final[, "geoMean_Hk"]
}
colnames(Rel_expression) <- c(paste0("RelExp_", names(efficiencies)[1:3]))
final <- data.frame(sampleID=pcr1$sampleID, age=pcr1$age, line=pcr1$line, final, Rel_expression)
stat <- final %>% select(sampleID, age, line, RelExp_B1, RelExp_B8, RelExp_B15)
stat$age_line <- paste(stat$age, stat$line, sep = "_")
lm1 <- lm(RelExp_B1 ~ line + age, data=stat)
lm2 <- lm(RelExp_B1 ~ age_line, data=stat)
summary(lm1)
summary(lm2)
lm2 <- lm(RelExp_B1~ 0 + line * age, data = final1)
stat <- final %>% select(sampleID, age, line, RelExp_B1, RelExp_B8, RelExp_B15)
stat$age_line <- paste(stat$age, stat$line, sep = "_")
lm1 <- lm(RelExp_B1 ~ line + age, data=stat)
lm2 <- lm(RelExp_B1 ~ age_line, data=stat)
summary(lm1)
summary(lm2)
lm2 <- lm(RelExp_B1~ 0 + line * age, data = final)
summary(lm2)
age <- stat$age
line <- stat$line
df1 <- reshape(stat, direction='long',
varying=4:6,
timevar='Transcript',
times=c('B1', 'B8', "B15"),
v.names=c('Rel_expression_ratio'),
idvar='sampleID')
df1 <- df1[,c("sampleID", "Transcript", "Rel_expression_ratio", "age", "line")]
df2 <- reshape(df1[,c(1,2,3)], direction = "wide",timevar="sampleID",idvar="Transcript")
df3 <- df2[,-1]
rownames(df3) <- df2[,1]
######################## KO vs TAG #################################
#expression in the first one compared to the second one.
library(limma)
#design <- model.matrix(~0+line)
#design <- model.matrix(~0+age)
design <- model.matrix(~0+age+line)
fit <- lmFit(df3,design)
#contrast.matrix <- makeContrasts("age3months-age1month",levels=design)
contrast.matrix <- makeContrasts("lineTAG-lineWT",levels=design)
fit <- contrasts.fit(fit,contrast.matrix)
fit=eBayes(fit)
names(fit)
DE <- summary(decideTests(fit,adjust.method="BH",p.value=0.05))
#results = topTable(fit,adjust.method="BH",sort.by="p")
results = topTable(fit)
######################## TAG vs WT #################################
fit <- lmFit(df3,design)
contrast.matrix <- makeContrasts("lineTAG-lineWT",levels=design)
fit <- contrasts.fit(fit,contrast.matrix)
fit=eBayes(fit)
names(fit)
DE <- summary(decideTests(fit,adjust.method="BH",p.value=0.05))
results = topTable(fit,adjust.method="BH", sort.by = "p")
####################### KO vs WT ##################################
fit <- lmFit(pcr3,design)
stat <- final %>% select(sampleID, age, line, RelExp_B1, RelExp_B8, RelExp_B15)
stat$age_line <- paste(stat$age, stat$line, sep = "_")
lm1 <- lm(RelExp_B1 ~ line + age, data=stat)
lm2 <- lm(RelExp_B1 ~ age_line, data=stat)
summary(lm1)
summary(lm2)
lm2 <- lm(RelExp_B1~ 0 + line * age, data = final)
summary(lm2)
age <- stat$age
line <- stat$line
df1 <- reshape(stat, direction='long',
varying=4:6,
timevar='Transcript',
times=c('B1', 'B8', "B15"),
v.names=c('Rel_expression_ratio'),
idvar='sampleID')
df1 <- df1[,c("sampleID", "Transcript", "Rel_expression_ratio", "age", "line")]
df2 <- reshape(df1[,c(1,2,3)], direction = "wide",timevar="sampleID",idvar="Transcript")
df3 <- df2[,-1]
rownames(df3) <- df2[,1]
######################## KO vs TAG #################################
#expression in the first one compared to the second one.
library(limma)
#design <- model.matrix(~0+line)
#design <- model.matrix(~0+age)
design <- model.matrix(~0+age+line)
fit <- lmFit(df3,design)
#contrast.matrix <- makeContrasts("age3months-age1month",levels=design)
contrast.matrix <- makeContrasts("lineTAG-lineWT",levels=design)
fit <- contrasts.fit(fit,contrast.matrix)
fit=eBayes(fit)
names(fit)
DE <- summary(decideTests(fit,adjust.method="BH",p.value=0.05))
#results = topTable(fit,adjust.method="BH",sort.by="p")
results = topTable(fit)
######################## TAG vs WT #################################
fit <- lmFit(df3,design)
contrast.matrix <- makeContrasts("lineTAG-lineWT",levels=design)
fit <- contrasts.fit(fit,contrast.matrix)
fit=eBayes(fit)
names(fit)
DE <- summary(decideTests(fit,adjust.method="BH",p.value=0.05))
results = topTable(fit,adjust.method="BH", sort.by = "p")
####################### KO vs WT ##################################
fit <- lmFit(df3,design)
contrast.matrix <- makeContrasts("genotypeKO-genotypeWT",levels=design)
View(df3)
View(df2)
View(df1)
design
stat <- final %>% select(sampleID, age, line, RelExp_B1, RelExp_B8, RelExp_B15)
stat$age_line <- paste(stat$age, stat$line, sep = "_")
lm1 <- lm(RelExp_B1 ~ line + age, data=stat)
lm2 <- lm(RelExp_B1 ~ age_line, data=stat)
summary(lm1)
summary(lm2)
lm2 <- lm(RelExp_B1~ 0 + line * age, data = final)
summary(lm2)
age <- stat$age
line <- stat$line
df1 <- reshape(stat, direction='long',
varying=4:6,
timevar='Transcript',
times=c('B1', 'B8', "B15"),
v.names=c('Rel_expression_ratio'),
idvar='sampleID')
df1 <- df1[,c("sampleID", "Transcript", "Rel_expression_ratio", "age", "line")]
df2 <- reshape(df1[,c(1,2,3)], direction = "wide",timevar="sampleID",idvar="Transcript")
df3 <- df2[,-1]
rownames(df3) <- df2[,1]
######################## KO vs TAG #################################
#expression in the first one compared to the second one.
library(limma)
#design <- model.matrix(~0+line)
#design <- model.matrix(~0+age)
design <- model.matrix(~0+age+line)
fit <- lmFit(df3,design)
#contrast.matrix <- makeContrasts("age3months-age1month",levels=design)
contrast.matrix <- makeContrasts("lineKO-lineTAG",levels=design)
?pheatmap
library("bookdown")
library(git2r)
install.packages("git2r")
install.packages("git2r", dependencies = T)
#install.packages("git2r", dependencies = T)
library(git2r)
clone("https://github.com/MdRasheduz-zaman/Nanopore", "/Users/md.rasheduzzaman/Downloads/Nanopore")
clone("https://github.com/MdRasheduz-zaman/Nanopore.git", "/Users/md.rasheduzzaman/Downloads/Nanopore")
#install.packages("git2r", dependencies = T)
library(git2r)
clone("https://github.com/MdRasheduz-zaman/Nanopore.git", "/Users/md.rasheduzzaman/Downloads/Nanopore")
clone("https://github.com/MdRasheduz-zaman/Nanopore.git", "/Users/md.rasheduzzaman/Downloads/Nanopore")
clone("git@github.com:MdRasheduz-zaman/Nanopore.git", "/Users/md.rasheduzzaman/Downloads/Nanopore")
test = matrix(rnorm(200), 20, 10)
test[1:10, seq(1, 10, 2)] = test[1:10, seq(1, 10, 2)] + 3
test[11:20, seq(2, 10, 2)] = test[11:20, seq(2, 10, 2)] + 2
test[15:20, seq(2, 10, 2)] = test[15:20, seq(2, 10, 2)] + 4
colnames(test) = paste("Test", 1:10, sep = "")
rownames(test) = paste("Gene", 1:20, sep = "")
# Draw heatmaps
pheatmap(test)
unlink("index_cache", recursive = TRUE)
library(purrr)
library(tibble)
library(tidyverse)
nKO <- 5 #No. of KO sample
nTAG <- 5 # No. of TAG sample
nWT <- 5 # No. of WT sample
set.seed(11)
geneB1 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 19, .08), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 19, .08), simplify = TRUE))
geneB8 <- rbind(replicate(n = 3, rnorm(nKO, 15, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 13.5, .08), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 13.5, .08), simplify = TRUE))
geneB15 <- rbind(replicate(n = 3, rnorm(nKO, 5.5, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 5, .08), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 5, .08), simplify = TRUE))
GOI1 <- data.frame(geneB1, geneB8, geneB15)
library(purrr)
library(tibble)
library(tidyverse)
nKO <- 5 #No. of KO sample
nTAG <- 5 # No. of TAG sample
nWT <- 5 # No. of WT sample
set.seed(11)
geneB1 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 19, .08), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 19, .08), simplify = TRUE))
geneB8 <- rbind(replicate(n = 3, rnorm(nKO, 15, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 13.5, .08), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 13.5, .08), simplify = TRUE))
geneB15 <- rbind(replicate(n = 3, rnorm(nKO, 5.5, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 5, .08), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 5, .08), simplify = TRUE))
GOI1 <- data.frame(geneB1, geneB8, geneB15)
Hk1 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 20, .1), simplify = TRUE))
Hk2 <- rbind(replicate(n = 3, rnorm(nKO, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 22, .1), simplify = TRUE))
Hk_1 <- data.frame(Hk1, Hk2)
day15 <- data.frame(GOI1, Hk_1)
colnames(day15) <- c(paste0("geneB1_run", seq(1:3)), paste0("geneB8_run", seq(1:3)), paste0("geneB15_run", seq(1:3)), paste0("Hk1_run", seq(1:3)), paste0("Hk2_run", seq(1:3)))
day15$sampleID <- c(paste0("KO", seq(1, nKO)),
paste0("TAG", seq(1, nTAG)),
paste0("WT", seq(1, nWT))) #naming sample/ID
day15 <- day15[, c(ncol(day15), 1:ncol(day15) - 1)] #reordering: last column at the beginning and others are in the same sequence
day15$age <- rep("15days", times = nrow(day15)) #adding age to all. nrow means how many sample
day15$line <- c(rep("KO", times = nKO), rep("TAG", times = nTAG), rep("WT", times = nWT))
geneB1_1 <- rbind(replicate(n = 3, rnorm(nKO, 15, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 13, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 13, .07), simplify = TRUE))
geneB8_1 <- rbind(replicate(n = 3, rnorm(nKO, 11, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 9.5, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 9.5, .07), simplify = TRUE))
geneB15_1 <- rbind(replicate(n = 3, rnorm(nKO, 4, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 3.5, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 3.5, .07), simplify = TRUE))
GOI2 <- data.frame(geneB1_1, geneB8_1, geneB15_1)
Hk1_1 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 20, .1), simplify = TRUE))
Hk2_1 <- rbind(replicate(n = 3, rnorm(nKO, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 22, .1), simplify = TRUE))
Hk_2 <- data.frame(Hk1_1, Hk2_1)
month1 <- data.frame(GOI2, Hk_2)
colnames(month1) <- c(paste0("geneB1_run", seq(1:3)), paste0("geneB8_run", seq(1:3)), paste0("geneB15_run", seq(1:3)), paste0("Hk1_run", seq(1:3)), paste0("Hk2_run", seq(1:3)))
month1$sampleID <- c(paste0("KO", seq(nKO+1, 2*nKO)),
paste0("TAG", seq(nTAG+1, 2*nTAG)),
paste0("WT", seq(nWT+1, 2*nWT)))
month1 <- month1[, c(ncol(month1), 1:ncol(month1) - 1)]
month1$age <- rep("1month", times = nrow(month1))
month1$line <- c(rep("KO", times = nKO), rep("TAG", times = nTAG), rep("WT", times = nWT))
geneB1_2 <- rbind(replicate(n = 3, rnorm(nKO, 12, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 10, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 10, .07), simplify = TRUE))
geneB8_2 <- rbind(replicate(n = 3, rnorm(nKO, 8, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 7, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 7, .07), simplify = TRUE))
geneB15_2 <- rbind(replicate(n = 3, rnorm(nKO, 4, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 3, .07), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 3, .07), simplify = TRUE))
GOI3 <- data.frame(geneB1_2, geneB8_2, geneB15_2)
Hk1_2 <- rbind(replicate(n = 3, rnorm(nKO, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 20, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 20, .1), simplify = TRUE))
Hk2_2 <- rbind(replicate(n = 3, rnorm(nKO, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nTAG, 22, .1), simplify = TRUE),
replicate(n = 3, rnorm(nWT, 22, .1), simplify = TRUE))
Hk_3 <- data.frame(Hk1_2, Hk2_2)
month3 <- data.frame(GOI3, Hk_3)
colnames(month3) <- c(paste0("geneB1_run", seq(1:3)), paste0("geneB8_run", seq(1:3)), paste0("geneB15_run", seq(1:3)), paste0("Hk1_run", seq(1:3)), paste0("Hk2_run", seq(1:3)))
month3$sampleID <- c(paste0("KO", seq(2*nKO+1, 3*nKO)),
paste0("TAG", seq(2*nTAG+1, 3*nTAG)),
paste0("WT", seq(2*nWT+1, 3*nWT)))
month3 <- month3[, c(ncol(month3), 1:ncol(month3) - 1)]
month3$age <- rep("3months", times = nrow(month3))
month3$line <- c(rep("KO", times = nKO), rep("TAG", times = nTAG), rep("WT", times = nWT))
pcr1 <- rbind(day15, month1, month3)
a <- pcr1 %>% select_if(is.numeric) %>% colnames()
pcr1$Ct_geneB1 <- apply(pcr1[, c(grep("geneB1_", a, ignore.case = TRUE, value = T))], 1, mean)
pcr1$Ct_geneB8 <- apply(pcr1[, c(grep("geneB8_", a, ignore.case = TRUE, value = T))], 1, mean)
pcr1$Ct_geneB15 <- apply(pcr1[, c(grep("geneB15_", a, ignore.case = TRUE, value = T))], 1, mean)
pcr1$Ct_Hk1 <- apply(pcr1[, c(grep("Hk1", a, ignore.case = TRUE, value = T))], 1, mean)
pcr1$Ct_Hk2 <- apply(pcr1[, c(grep("Hk2", a, ignore.case = TRUE, value = T))], 1, mean)
data1 <- pcr1[, c("sampleID", "age", "line", "Ct_geneB1", "Ct_geneB8", "Ct_geneB15", "Ct_Hk1", "Ct_Hk2")]
efficiencies <- c(1.98, 2, 2.02, 2.01, 2.01)
names(efficiencies) <- c("B1", "B8", "B15", "Hk1", "Hk2")
calibrator <- data1[data1$line == "WT" & data1$age == "15days",] %>% select_if(is.numeric)
Ct_avg <- apply(calibrator, 2, mean)
Ct <- data1 %>% select_if(is.numeric)
delta_Ct <- matrix(nrow=nrow(Ct), ncol=ncol(Ct))
for(i in 1:ncol(Ct)) {
delta_Ct[ , i] <- Ct_avg[[i]] - Ct[ , i]
}
colnames(delta_Ct) <- c(paste0("delta", names(Ct)))
RQ <- matrix(nrow=nrow(delta_Ct), ncol=ncol(delta_Ct))
for(i in 1:length(efficiencies)) {
RQ[ , i] <-  efficiencies[i]^delta_Ct[,i]
}
colnames(RQ) <- c(paste0("RQ_", names(efficiencies)))
geoMean_Hk <- apply(RQ[, 4:5], 1, function(x) exp(mean(log(x))))
final <- cbind(delta_Ct, RQ, geoMean_Hk)
nGOI <- 3
Rel_expression <- matrix(nrow=nrow(final), ncol=nGOI)
for(i in 1:nGOI) {
Rel_expression[ , i] <-  RQ[, i]/final[, "geoMean_Hk"]
}
colnames(Rel_expression) <- c(paste0("RelExp_", names(efficiencies)[1:3]))
final <- data.frame(sampleID=pcr1$sampleID, age=pcr1$age, line=pcr1$line, final, Rel_expression)
stat <- final %>% select(sampleID, age, line, RelExp_B1, RelExp_B8, RelExp_B15)
stat$age_line <- paste(stat$age, stat$line, sep = "_")
lm1 <- lm(RelExp_B1 ~ line + age, data=stat)
lm2 <- lm(RelExp_B1 ~ age_line, data=stat)
summary(lm1)
summary(lm2)
lm2 <- lm(RelExp_B1~ 0 + line * age, data = final)
summary(lm2)
age <- stat$age
line <- stat$line
df1 <- reshape(stat, direction='long',
varying=4:6,
timevar='Transcript',
times=c('B1', 'B8', "B15"),
v.names=c('Rel_expression_ratio'),
idvar='sampleID')
df1 <- df1[,c("sampleID", "Transcript", "Rel_expression_ratio", "age", "line")]
df2 <- reshape(df1[,c(1,2,3)], direction = "wide",timevar="sampleID",idvar="Transcript")
df3 <- df2[,-1]
rownames(df3) <- df2[,1]
######################## KO vs TAG #################################
#expression in the first one compared to the second one.
library(limma)
######################## KO vs TAG #################################
#expression in the first one compared to the second one
install.packages("limma")
R.version
